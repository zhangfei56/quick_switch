---
globs: *.swift
description: Swift 编码规范和最佳实践
---

# Swift 编码规范

## 代码风格
- 使用 Swift 官方编码规范
- 所有代码必须经过 SwiftLint 检查
- 使用 4 个空格缩进，不使用 Tab
- 行长度限制为 120 字符
- 使用驼峰命名法：类名大写开头，变量和方法名小写开头

## 架构模式
- 遵循 MVVM 架构模式
- 使用依赖注入进行模块解耦
- 实现协议导向编程
- 使用 Combine 框架进行响应式编程

## 错误处理
- 使用 Result 类型处理可能失败的操作
- 实现自定义错误类型
- 提供详细的错误信息和恢复建议
- 记录所有错误到日志系统

## 性能要求
- 所有 UI 操作必须在主线程执行
- 耗时操作使用异步处理
- 实现对象池模式重用频繁创建的对象
- 使用懒加载优化内存使用

## 内存管理
- 避免循环引用，使用 weak 和 unowned
- 及时释放不需要的资源
- 使用 Instruments 检测内存泄漏
- 实现自动释放池管理临时对象

## 测试要求
- 核心功能必须达到 100% 测试覆盖
- 使用 XCTest 框架编写单元测试
- 实现集成测试验证端到端功能
- 所有公共 API 必须有对应的测试用例